#Basic webrequest setup for Python. 
#As is, this sends a webrequest to esi.tech.ccp.is to the market endpoint/regionid/orders endpoint with relevant ItemID parameters, gets the sell orders, then parses that. 
#Basically this just exists because I got sick of fraggin' powershell

import urllib3
import certifi
import json
from operator import itemgetter
#imports necessary modules. I'm almost sure this isn't good practice but whatever.

https = urllib3.PoolManager(
    cert_reqs='CERT_REQUIRED',
    ca_certs=certifi.where())
#establishes poolmanager and enables certificate verification for HTTPS requests.

r = https.request('GET', 'https://esi.tech.ccp.is/latest/markets/10000044/orders/?datasource=tranquility&order_type=sell&page=1&type_id=39')
#The webrequest itself.

parsed_r = json.loads(r.data)
#loads the data saved from the webrequest via the .loads() method. Note: Each order in the JSON set is considered a dictionary by python.
#Saving it to the variable here makes it a list of dictionaries.

sorted_r = sorted(parsed_r, key=itemgetter('price')) 
#sorts the data (parsed_r) by price descending. itemgetter is necessary because sorted_r is a list of dictionaries.

for dict_item in sorted_r:
    for key in dict_item:
        print("{} and {}".format(dict_item['price'],dict_item['location_id']))

#Iterates through each item in the list 'sorted_r'
#        then iterates through each 'price' key/value pair in each dictionary in said list. 

#10000044 
